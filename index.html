<!doctype html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <!-- <meta http-equiv="Content-Security-Policy" content="default-src *; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline' 'unsafe-eval'"> -->
        <meta name="format-detection" content="telephone=no" />
        
        <title>Purple</title>
        
        <script src="cordova.js"></script>

        <!-- COURIER APP ONLY -->
        <script type="text/javascript">
         
         // function askUserToReload () {
         //     var windowReload = confirm("Your internet connection is unstable. Reload?");
         //     if (windowReload === true) {
         //         window.location.reload();
         //     }
         // }

         // var courierReloadTimer = setTimeout(function(){askUserToReload()}, 12000);
         
        </script>
        <!-- END OF COURIER APP ONLY -->

        <script>
         // if version outdated, clear all sencha localStorage caches
         if (localStorage['lastCacheVersionNumber'] !== "1.4.0") {
             for (key in localStorage) {
                 // all of them start with a guid
                 if (key.length > 37 &&
                     (key.substring(0, 38).match(/-/g) || []).length === 5) {
                         localStorage.removeItem(key);
                 }
             }
         }
         
         function handleOpenURL (url) {
            if (typeof window.util === "undefined") {
                window.queuedDeepLinkUrl = url;
            } else {
                util.handleDeepLinkUrl(url);
            }
         }
         // iOS
         function onNotificationAPN (event) {
             if (event.alert) {
                 navigator.notification.alert(
                     event.alert,
                     function(){},
                     "Notification"
                 );
             }

             if (event.sound) {
                 var snd = new Media(event.sound);
                 snd.play();
             }

             if (event.badge) {
                 window.plugins.pushNotification.setApplicationIconBadgeNumber(
                     function() {console.log("badge success");},
                     function() {console.log("badge error");},
                     event.badge
                 );
             }

             // update/reload orders list view
             util.ctl('Orders').loadOrdersList(true, util.ctl('Orders').refreshOrder);
             // if on a specific order page, just go back to the orders list
             // because it gets complicated to update the particular order page
             // if (util.ctl('Orders').getOrder() !== null) {
             //     util.ctl('Orders').backToOrders();
             // }
         }

         // Android
         function onNotification(e) {
             switch( e.event ) {
                 case 'registered':
                     if ( e.regid.length > 0 ) {
                         // Your GCM push server needs to know the regID before it can push to this device
                         // here is where you might want to send it the regID for later use.
                         util.ctl('Main').registerDeviceForPushNotifications(e.regid, "gcm");
                     }
                     break;

                 case 'message':
                     var message = (e["payload"]["default"] || e.payload.message);
                     var fromValidSource = (util.GCM_SENDER_ID === e["from"]);

                     if (e.foreground) {
                         //console.log("foreground notification");
                     } else {
                         // otherwise we were launched because the user touched a notification in the notification tray.
                         if (e.coldstart) {
                             //console.log("background coldstart notification");
                         } else {
                             //console.log("background no coldstart notification");
                         }
                     }

                     if (fromValidSource) {
                         navigator.notification.alert(
                             message,
                             function(){},
                             "Notification"
                         );
                         // update/reload orders list view
                         util.ctl('Orders').loadOrdersList(true, util.ctl('Orders').refreshOrder);
                         // if on a specific order page, just go back to the orders list
                         // because it gets complicated to update the particular order page
                         // if (util.ctl('Orders').getOrder() !== null) {
                         //     util.ctl('Orders').backToOrders();
                         // }
                     }
                     
                     break;

                 case 'error':
                     console.log('ERROR -> MSG:' + e.msg);
                     break;

                 default:
                     console.log('EVENT -> Unknown, an event was received and we do not know what it is');
                     break;
             }
         }
        </script>

        <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA0p8k_hdb6m-xvAOosuYQnkDwjsn8NjFg&libraries=places"></script>
        
        <script id="microloader" type="text/javascript" src=".sencha/app/microloader/development.js"></script>
        
        <script type="text/javascript" src="https://js.stripe.com/v2/"></script>

        <script type="text/javascript">
         !function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","page","once","off","on"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t){var e=document.createElement("script");e.type="text/javascript";e.async=!0;e.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)};analytics.SNIPPET_VERSION="3.1.0";
         }}();
        </script>
    </head>
    <body style="background-color: #423970;">
        
    </body>
</html>
